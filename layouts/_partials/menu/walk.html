{{- /* layouts/partials/menu/walk.html */ -}}
{{- $page    := .page    -}}
{{- $menuID  := .menuID  -}}

{{- range .menuEntries }}
  {{- $attrs := dict "href" .URL }}
  {{- if $page.IsMenuCurrent .Menu . }}
        {{- $attrs = merge $attrs (dict "class" "active"   "aria-current" "page") }}
  {{- else if $page.HasMenuCurrent .Menu . }}
        {{- $attrs = merge $attrs (dict "class" "ancestor" "aria-current" "true") }}
  {{- end }}

  {{- $name := .Name }}
  {{- with .Identifier }}{{ with T . }}{{ $name = . }}{{ end }}{{ end }}

  <li>
    <a{{- range $k,$v := $attrs }} {{ printf "%s=%q" $k $v | safeHTMLAttr }}{{- end }}>{{ $name }}</a>
    {{- with .Children }}
      <ul>
        {{- /* ★ 再帰呼び出し時も $menuID を渡す */ -}}
        {{- partial "menu/walk.html"
             (dict "page" $page "menuEntries" . "menuID" $menuID) -}}
      </ul>
    {{- end }}
  </li>
{{- end }}
